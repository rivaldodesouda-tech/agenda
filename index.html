<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Planejador de Agenda Interativo</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Biblioteca para gerar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div id="app">
        <div id="mainView" class="main-view">
            <div class="header no-print">
                <button id="prevNav" class="btn-nav-arrow">‚Äπ</button>
                <div class="header-title">
                    <h1 id="headerTitle">Dez 2025</h1>
                </div>
                <button id="nextNav" class="btn-nav-arrow">‚Ä∫</button>
            </div>

            <div class="view-controls no-print">
                <button id="viewWeekly" class="view-btn active">üìÖ Semanal</button>
                <button id="viewMonthly" class="view-btn">üìÜ Mensal</button>
                <button id="printMonthBtn" class="btn btn-print">üñ®Ô∏è Imprimir M√™s</button>
                <button id="exportPdfBtn" class="btn btn-pdf" style="display:none;">üìÑ Exportar PDF</button>
                <button id="printWeekBtn" class="btn btn-print">üñ®Ô∏è Imprimir Semana</button>
                <button id="exportDataBtn" class="btn btn-secondary">üíæ Exportar Dados</button>
                <input type="file" id="importFileInput" style="display: none;" accept=".json">
                <button id="importDataBtn" class="btn btn-secondary">üì• Importar Dados</button>
            </div>

            <div id="weekView" class="week-view-container">
                <div id="weekGrid" class="week-grid"></div>
            </div>

            <div id="monthView" class="month-view" style="display: none;">
                <div id="monthPrintHeader" class="month-print-header" style="display: none;">
                    <h1 id="monthPrintTitle"></h1>
                </div>
                <div id="monthCalendar" class="month-calendar"></div>
            </div>
        </div>

        <div id="dayEditView" class="day-edit-view" style="display: none;">
            <div class="edit-header no-print">
                <div class="edit-header-left">
                    <span id="editDayInfo" class="edit-day-info"></span>
                </div>
                <div class="edit-header-right">
                    <button id="printDay" class="btn btn-primary">üñ®Ô∏è Imprimir</button>
                    <button id="closeDayEdit" class="btn btn-secondary">‚úï Fechar</button>
                </div>
            </div>

            <div class="edit-toolbar no-print">
                <div class="toolbar-group">
                    <button onclick="formatDoc('bold')" title="Negrito"><b>B</b></button>
                    <button onclick="formatDoc('italic')" title="It√°lico"><i>I</i></button>
                    <button onclick="formatDoc('underline')" title="Sublinhado"><u>U</u></button>
                    <button onclick="formatDoc('strikeThrough')" title="Tracejado"><s>S</s></button>
                </div>
                <div class="toolbar-group">
                    <select onchange="formatDoc('fontSize', this.value); this.selectedIndex=0;">
                        <option value="">Tamanho</option>
                        <option value="1">Muito Pequeno</option>
                        <option value="2">Pequeno</option>
                        <option value="3">Normal</option>
                        <option value="4">Grande</option>
                        <option value="5">Muito Grande</option>
                        <option value="6">Enorme</option>
                    </select>
                </div>
                <div class="toolbar-group">
                    <span class="label">Cores:</span>
                    <div id="colorPalette" class="color-buttons"></div>
                </div>
            </div>

            <div class="edit-content">
                <div id="dayPrintHeader" class="print-only day-print-header">
                    <div class="print-date" id="printDate"></div>
                    <div class="print-day-name" id="printDayName"></div>
                    <hr class="print-divider">
                </div>
                <div class="notebook-container">
                    <div id="notebookLines" class="notebook-lines"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURA√á√ïES E ESTADO ==========
        var COLORS = ['#FF0000', '#FF6B00', '#FFD700', '#00D000', '#0066FF', '#6600FF', '#FF00FF', '#FF1493', '#00FF7F', '#FF4500', '#1E90FF', '#DC143C', '#00CED1', '#FFB6C1', '#32CD32', '#FF8C00', '#00FF00', '#FF69B4', '#000000', '#808080', '#FFFFFF'];
        var FERIADOS_BRASIL = ['01-01', '02-13', '04-21', '05-01', '09-07', '10-12', '11-02', '11-20', '12-25'];
        
        var appState = {
            currentDate: new Date(),
            selectedDay: null,
            selectedLineIndex: null,
            days: {},
            view: 'week'
        };

        // ========== UTILIT√ÅRIOS ==========
        function getDateString(date) {
            var y = date.getFullYear();
            var m = String(date.getMonth() + 1).padStart(2, '0');
            var d = String(date.getDate()).padStart(2, '0');
            return y + '-' + m + '-' + d;
        }

        function getDayName(dayIndex) {
            var days = ['Domingo', 'Segunda-feira', 'Ter√ßa-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'S√°bado'];
            return days[dayIndex];
        }

        function isHolidayDate(date) {
            var m = String(date.getMonth() + 1).padStart(2, '0');
            var d = String(date.getDate()).padStart(2, '0');
            return FERIADOS_BRASIL.indexOf(m + '-' + d) !== -1;
        }

        function isDarkColor(color) {
            if (!color) return false;
            if (color.startsWith('rgb')) {
                var rgb = color.match(/\d+/g);
                var r = parseInt(rgb[0]), g = parseInt(rgb[1]), b = parseInt(rgb[2]);
            } else {
                var hex = color.replace('#', '');
                if (hex.length === 3) hex = hex.split('').map(function(s){return s+s}).join('');
                var r = parseInt(hex.substr(0, 2), 16);
                var g = parseInt(hex.substr(2, 2), 16);
                var b = parseInt(hex.substr(4, 2), 16);
            }
            var luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            return luminance < 0.5;
        }

        function formatDoc(cmd, val) {
            if (cmd === 'hiliteColor') {
                document.execCommand('hiliteColor', false, val);
                // Aplicar cor de texto contrastante automaticamente
                var textColor = isDarkColor(val) ? '#FFFFFF' : '#000000';
                document.execCommand('foreColor', false, textColor);
            } else {
                document.execCommand(cmd, false, val);
            }
            
            if (appState.selectedLineIndex !== null) {
                var el = document.querySelector('[data-index="' + appState.selectedLineIndex + '"]');
                if (el) updateLine(appState.selectedLineIndex, el);
            }
        }

        // ========== ARMAZENAMENTO ==========
        function saveData() { localStorage.setItem('plannerData', JSON.stringify(appState.days)); }
        function loadData() {
            var stored = localStorage.getItem('plannerData');
            if (stored) appState.days = JSON.parse(stored);
        }

        // ========== RENDERIZA√á√ÉO ==========
        function renderWeekView() {
            var weekGrid = document.getElementById('weekGrid');
            if (!weekGrid) return;
            weekGrid.innerHTML = '';

            var startDate = new Date(appState.currentDate);
            var dayOfWeek = appState.currentDate.getDay();
            var daysToSubtract = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
            startDate.setDate(appState.currentDate.getDate() - daysToSubtract);

            document.getElementById('headerTitle').textContent = startDate.toLocaleDateString('pt-BR', { month: 'short', year: 'numeric' }).toUpperCase();

            var leftCol = document.createElement('div'); leftCol.className = 'week-column';
            var rightCol = document.createElement('div'); rightCol.className = 'week-column';

            for (var i = 0; i < 7; i++) {
                var date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                var card = createDayCard(date);
                if (i < 4) leftCol.appendChild(card); else rightCol.appendChild(card);
            }

            weekGrid.appendChild(leftCol);
            weekGrid.appendChild(rightCol);
            
            document.getElementById('weekView').style.display = 'flex';
            document.getElementById('monthView').style.display = 'none';
            document.getElementById('viewWeekly').classList.add('active');
            document.getElementById('viewMonthly').classList.remove('active');
            
            document.getElementById('exportPdfBtn').style.display = 'none';
        }

        function createDayCard(date) {
            var card = document.createElement('div');
            var dateStr = getDateString(date);
            var isWeekend = date.getDay() === 0 || date.getDay() === 6;
            var isHoliday = isHolidayDate(date);
            var isSpecial = isWeekend || isHoliday;
            
            card.className = 'day-card-grid' + (isSpecial ? ' special-day' : '');
            
            // Cabe√ßalho para tela
            var header = document.createElement('div');
            header.className = 'day-card-header no-print' + (isSpecial ? ' special-day' : '');
            var dayNameShort = getDayName(date.getDay()).split('-')[0].toUpperCase();
            header.innerHTML = '<span class="day-name-label">' + dayNameShort + ' ' + date.getDate() + '</span>';
            
            // Cabe√ßalho para impress√£o (conforme modelo)
            var printHeader = document.createElement('div');
            printHeader.className = 'print-only day-print-header';
            var day = String(date.getDate()).padStart(2, '0');
            var month = String(date.getMonth() + 1).padStart(2, '0');
            var year = date.getFullYear();
            printHeader.innerHTML = '<div class="print-date">' + day + '/' + month + '/' + year + '</div>' +
                                   '<div class="print-day-name">' + getDayName(date.getDay()) + '</div>' +
                                   '<hr class="print-divider">';

            // Conte√∫do
            var content = document.createElement('div');
            content.className = 'day-card-content';
            content.onclick = function() { openDayEdit(dateStr); };
            
            var dayData = appState.days[dateStr] || {};
            var lines = dayData.lines || [];
            
            var contentColumns = document.createElement('div');
            contentColumns.className = 'day-content-columns';
            
            var columnParts = [
                document.createElement('div'),
                document.createElement('div'),
                document.createElement('div')
            ];
            columnParts.forEach(function(col) { col.className = 'day-column-part'; });
            
            for (var j = 0; j < 30; j++) {
                var lineWrapper = document.createElement('div');
                lineWrapper.className = 'day-line-wrapper';
                
                var lineNumber = document.createElement('span');
                lineNumber.className = 'line-number-preview';
                lineNumber.textContent = (j + 1) + '.';
                
                var linePreview = document.createElement('span');
                linePreview.className = 'day-line-preview';
                linePreview.innerHTML = lines[j] || '';
                
                lineWrapper.appendChild(lineNumber);
                lineWrapper.appendChild(linePreview);
                
                var colIndex = Math.floor(j / 10);
                columnParts[colIndex].appendChild(lineWrapper);
            }
            
            columnParts.forEach(function(col) { contentColumns.appendChild(col); });
            content.appendChild(contentColumns);
            
            card.appendChild(header);
            card.appendChild(printHeader);
            card.appendChild(content);
            
            return card;
        }

                function renderMonthView() {
            var monthCalendar = document.getElementById('monthCalendar');
            if (!monthCalendar) return;
            monthCalendar.innerHTML = '';

            var year = appState.currentDate.getFullYear();
            var month = appState.currentDate.getMonth();
            var firstDayOfMonth = new Date(year, month, 1);
            var lastDayOfMonth = new Date(year, month + 1, 0);
            
            document.getElementById('headerTitle').textContent = appState.currentDate.toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' }).toUpperCase();
            document.getElementById('monthPrintTitle').textContent = document.getElementById('headerTitle').textContent;

            var monthGrid = document.createElement('div');
            monthGrid.className = 'month-grid';
            
            // Cabe√ßalhos dos dias da semana
            var weekDays = ['SEG', 'TER', 'QUA', 'QUI', 'SEX', 'S√ÅB', 'DOM'];
            weekDays.forEach(function(day, index) {
                var dayHeader = document.createElement('div');
                dayHeader.className = 'month-day-header' + (index >= 5 ? ' special-day' : '');
                dayHeader.textContent = day;
                monthGrid.appendChild(dayHeader);
            });

            // Ajustar para come√ßar na Segunda-feira (alinhamento)
            var startDayOfWeek = firstDayOfMonth.getDay();
            var daysToPrepend = startDayOfWeek === 0 ? 6 : startDayOfWeek - 1;

            // C√©lulas vazias no in√≠cio
            for (var p = 0; p < daysToPrepend; p++) {
                var emptyCell = document.createElement('div');
                emptyCell.className = 'month-day-cell empty-cell';
                monthGrid.appendChild(emptyCell);
            }

            // C√©lulas do calend√°rio - Apenas dias do m√™s atual
            var totalDays = lastDayOfMonth.getDate();
            for (var i = 1; i <= totalDays; i++) {
                var currentDate = new Date(year, month, i);
                var cell = createMonthCell(currentDate);
                monthGrid.appendChild(cell);
            }
            
            // C√©lulas vazias no final para completar apenas a √∫ltima semana
            var totalCellsSoFar = daysToPrepend + totalDays;
            var remainingCells = (7 - (totalCellsSoFar % 7)) % 7;
            if (remainingCells > 0) {
                 for (var r = 0; r < remainingCells; r++) {
                    var emptyCell = document.createElement('div');
                    emptyCell.className = 'month-day-cell empty-cell';
                    monthGrid.appendChild(emptyCell);
                }
            }

            monthCalendar.appendChild(monthGrid);
            
            document.getElementById('weekView').style.display = 'none';
            document.getElementById('monthView').style.display = 'flex';
            document.getElementById('monthPrintHeader').style.display = 'none';
            document.getElementById('viewWeekly').classList.remove('active');
            document.getElementById('viewMonthly').classList.add('active');
            
            document.getElementById('exportPdfBtn').style.display = 'block';
        }


        function createMonthCell(date) {
            var cell = document.createElement('div');
            var dateStr = getDateString(date);
            var isWeekend = date.getDay() === 0 || date.getDay() === 6;
            var isHoliday = isHolidayDate(date);
            var isSpecial = isWeekend || isHoliday;
            cell.className = 'month-day-cell' + (isSpecial ? ' special-day' : '');
            cell.onclick = function() { openDayEdit(dateStr); };
            
            // N√∫mero do dia
            var numContainer = document.createElement('div');
            numContainer.className = 'month-day-num-container';
            var num = document.createElement('span');
            num.className = 'month-day-num';
            num.textContent = date.getDate();
            numContainer.appendChild(num);
            cell.appendChild(numContainer);
            
            // Conte√∫do
            var dayData = appState.days[dateStr] || {};
            var lines = dayData.lines || [];
            
            var content = document.createElement('div');
            content.className = 'month-cell-content';
            
            var columnParts = [
                document.createElement('div'),
                document.createElement('div'),
                document.createElement('div')
            ];
            columnParts.forEach(function(col) { col.className = 'month-column-part'; });
            
            for (var j = 0; j < 30; j++) {
                var contentText = lines[j] || '';
                // Filtrar: S√≥ mostrar se tiver conte√∫do (n√£o vazio e n√£o apenas espa√ßos/tags vazias)
                var hasContent = contentText.replace(/<[^>]*>/g, '').trim().length > 0;
                
                if (hasContent) {
                    var lineWrapper = document.createElement('div');
                    lineWrapper.className = 'month-line-rich';
                    lineWrapper.innerHTML = (j + 1) + '. ' + contentText;
                    var colIndex = Math.floor(j / 10);
                    columnParts[colIndex].appendChild(lineWrapper);
                }
            }
            
            columnParts.forEach(function(col) { content.appendChild(col); });
            cell.appendChild(content);
            
            return cell;
        }

        function openDayEdit(dateStr) {
            appState.selectedDay = dateStr;
            // Usar T00:00:00 para garantir que a data seja interpretada no fuso hor√°rio local
            var date = new Date(dateStr + 'T00:00:00');
            
            document.getElementById('editDayInfo').textContent = getDayName(date.getDay()) + ', ' + date.getDate() + ' de ' + date.toLocaleDateString('pt-BR', { month: 'long' });
            document.getElementById('printDate').textContent = date.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', year: 'numeric' });
            document.getElementById('printDayName').textContent = getDayName(date.getDay());
            
            document.getElementById('dayEditView').style.display = 'flex';
            document.getElementById('mainView').style.display = 'none';
            document.body.classList.add('editing-day');
            
            renderNotebookLines();
            renderColorPalette();
        }

        function renderNotebookLines() {
            var notebookLines = document.getElementById('notebookLines');
            notebookLines.innerHTML = '';
            
            var dayData = appState.days[appState.selectedDay] || {};
            var lines = dayData.lines || [];
            
            for (var i = 0; i < 30; i++) {
                var lineWrapper = document.createElement('div');
                lineWrapper.className = 'notebook-line-wrapper';
                
                var lineNumber = document.createElement('span');
                lineNumber.className = 'line-number';
                lineNumber.textContent = (i + 1) + '.';
                
                var line = document.createElement('div');
                line.className = 'notebook-line';
                line.contentEditable = true;
                line.setAttribute('data-index', i);
                line.innerHTML = lines[i] || '';
                
                line.oninput = function(e) { updateLine(parseInt(e.target.getAttribute('data-index')), e.target); };
                line.onfocus = function(e) { appState.selectedLineIndex = parseInt(e.target.getAttribute('data-index')); };
                line.onblur = function() { appState.selectedLineIndex = null; };
                
                // Suporte para Tab e Enter no iPhone/iOS
                line.onkeydown = function(e) {
                    if (e.key === 'Enter' || e.keyCode === 13 || e.key === 'Tab' || e.keyCode === 9) {
                        e.preventDefault();
                        var nextIndex = parseInt(this.getAttribute('data-index')) + 1;
                        if (nextIndex < 30) {
                            var nextLine = document.querySelector('[data-index="' + nextIndex + '"]');
                            if (nextLine) {
                                nextLine.focus();
                                // Posicionar cursor no final para iOS
                                var range = document.createRange();
                                var sel = window.getSelection();
                                range.selectNodeContents(nextLine);
                                range.collapse(false);
                                sel.removeAllRanges();
                                sel.addRange(range);
                            }
                        }
                    }
                };
                
                lineWrapper.appendChild(lineNumber);
                lineWrapper.appendChild(line);
                notebookLines.appendChild(lineWrapper);
            }
        }

        function updateLine(index, element) {
            if (!appState.days[appState.selectedDay]) appState.days[appState.selectedDay] = { lines: [] };
            appState.days[appState.selectedDay].lines[index] = element.innerHTML;
            saveData();
        }

        function renderColorPalette() {
            var colorPalette = document.getElementById('colorPalette');
            colorPalette.innerHTML = '';
            
            COLORS.forEach(function(color) {
                var btn = document.createElement('button');
                btn.className = 'color-btn';
                btn.style.backgroundColor = color;
                btn.onclick = function() { formatDoc('hiliteColor', color); };
                colorPalette.appendChild(btn);
            });
        }

        function closeDayEdit() {
            document.getElementById('dayEditView').style.display = 'none';
            document.getElementById('mainView').style.display = 'flex';
            document.body.classList.remove('editing-day');
            appState.view === 'week' ? renderWeekView() : renderMonthView();
        }

        function exportToPdf() {
            var element = document.getElementById('monthView');
            var header = document.querySelector('.header');
            var controls = document.querySelector('.view-controls');
            var monthPrintHeader = document.getElementById('monthPrintHeader');
            var monthPrintTitle = document.getElementById('monthPrintTitle');
            
            // Configurar o t√≠tulo do m√™s/ano para o PDF
            if (monthPrintTitle) {
                var monthYear = appState.currentDate.toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' });
                monthPrintTitle.textContent = monthYear.charAt(0).toUpperCase() + monthYear.slice(1);
            }

            element.classList.add('pdf-export-mode');
            if(monthPrintHeader) monthPrintHeader.style.display = 'block'; // Mostrar t√≠tulo no PDF
            if(header) header.style.display = 'none';
            if(controls) controls.style.display = 'none';

            var opt = {
                margin:       [5, 5, 5, 5],
                filename:     'calendario-' + appState.currentDate.getFullYear() + '-' + (appState.currentDate.getMonth()+1) + '.pdf',
                image:        { type: 'jpeg', quality: 1 },
                html2canvas:  { 
                    scale: 2,
                    useCORS: true, 
                    logging: false,
                    letterRendering: true,
                    windowWidth: 1600 // Ajustado para um tamanho mais padr√£o que capture bem o grid
                },
                jsPDF:        { unit: 'mm', format: 'a4', orientation: 'landscape' },
                pagebreak:    { mode: 'avoid-all' }
            };
            
            html2pdf().set(opt).from(element).save().then(function() {
                element.classList.remove('pdf-export-mode');
                if(monthPrintHeader) monthPrintHeader.style.display = 'none'; // Ocultar novamente ap√≥s gerar
                if(header) header.style.display = 'flex';
                if(controls) controls.style.display = 'flex';
            });
        }

        function exportDataToJson() {
            var dataStr = JSON.stringify(appState.days, null, 2);
            var blob = new Blob([dataStr], { type: "application/json" });
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'agenda_data_' + new Date().toISOString().slice(0, 10) + '.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function exportWeekToPdf() {
            var element = document.getElementById('weekView');
            var header = document.querySelector('.header');
            var controls = document.querySelector('.view-controls');
            
            element.classList.add('pdf-export-mode');
            if(header) header.style.display = 'none';
            if(controls) controls.style.display = 'none';

            var opt = {
                margin:       5,
                filename:     'agenda-semanal-' + appState.currentDate.getFullYear() + '-' + (appState.currentDate.getMonth()+1) + '.pdf',
                image:        { type: 'jpeg', quality: 1 },
                html2canvas:  { scale: 2, useCORS: true, logging: false },
                jsPDF:        { unit: 'mm', format: 'a4', orientation: 'landscape' }
            };
            
            html2pdf().set(opt).from(element).save().then(function() {
                element.classList.remove('pdf-export-mode');
                if(header) header.style.display = 'flex';
                if(controls) controls.style.display = 'flex';
            });
        }

        // ========== INICIALIZA√á√ÉO ==========
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            renderWeekView();
            document.getElementById('prevNav').onclick = function() {
                if (appState.view === 'week') appState.currentDate.setDate(appState.currentDate.getDate() - 7);
                else appState.currentDate.setMonth(appState.currentDate.getMonth() - 1);
                appState.view === 'week' ? renderWeekView() : renderMonthView();
            };
            document.getElementById('nextNav').onclick = function() {
                if (appState.view === 'week') appState.currentDate.setDate(appState.currentDate.getDate() + 7);
                else appState.currentDate.setMonth(appState.currentDate.getMonth() + 1);
                appState.view === 'week' ? renderWeekView() : renderMonthView();
            };
            document.getElementById('viewWeekly').onclick = function() { appState.view = 'week'; renderWeekView(); };
            document.getElementById('viewMonthly').onclick = function() { appState.view = 'month'; renderMonthView(); };
            document.getElementById('closeDayEdit').onclick = closeDayEdit;
            
            document.getElementById('exportDataBtn').onclick = exportDataToJson;
            document.getElementById('importDataBtn').onclick = function() {
                document.getElementById('importFileInput').click();
            };

            document.getElementById('importFileInput').addEventListener('change', function(event) {
                var file = event.target.files[0];
                if (!file) return;

                var reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        var importedData = JSON.parse(e.target.result);
                        if (typeof importedData === 'object' && importedData !== null) {
                            // Limpar o conte√∫do existente e substituir pelo novo
                            appState.days = {}; 
                            Object.assign(appState.days, importedData);
                            saveData();
                            alert('Dados importados com sucesso! A agenda ser√° recarregada.');
                            // Recarregar a visualiza√ß√£o atual para refletir os novos dados
                            appState.view === 'week' ? renderWeekView() : renderMonthView();
                        } else {
                            alert('Erro: O arquivo JSON n√£o cont√©m dados v√°lidos.');
                        }
                    } catch (error) {
                        alert('Erro ao processar o arquivo JSON: ' + error.message);
                    }
                };
                reader.readAsText(file);
            });

            document.getElementById('exportPdfBtn').onclick = function() {
                if (appState.view === 'week') exportWeekToPdf();
                else exportToPdf();
            };
            
            document.getElementById('printWeekBtn').onclick = function() {
                appState.view = 'week';
                renderWeekView();
                setTimeout(function() { window.print(); }, 500);
            };
            
            document.getElementById('printMonthBtn').onclick = function() {
                appState.view = 'month';
                renderMonthView();
                var element = document.getElementById('monthView');
                element.classList.add('print-mode');
                setTimeout(function() { 
                    window.print(); 
                    element.classList.remove('print-mode');
                }, 500);
            };
            
            document.getElementById('printDay').onclick = function() {
                window.print();
            };
        });
    </script>
</body>
</html>
